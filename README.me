# üå± PhytoController - Smart Phytolighting Controller

An automated system for controlling high-power phytolamps based on actual light levels.

## üéØ System Purpose

The controller is designed for automatic control of phyto-LEDs (30-50W) in mixed lighting conditions:
- **Sunlight** - primary source  
- **Phytolamps** - supplemental lighting when natural light is insufficient

## üîå Hardware Components

### Main Components
- **Controller**: ESP32-WROOM with CP2102
- **Light Sensor**: GY-30 (BH1750) or VEML7700
- **Load Control**: 12V Relay via TIP122 transistor
- **Indication**: WS2812B RGB LED
- **Power Supply**: 5V‚Üí12V Boost converter

### Connection Diagram

ESP32-WROOM (CP2102)

‚îú‚îÄ‚îÄ üîå RELAY SCHEMATIC
‚îÇ   GPIO4 ‚Üí 680Œ© Resistor ‚Üí TIP122 Base
‚îÇ   TIP122 Collector ‚Üí Relay coil
‚îÇ   TIP122 Emitter ‚Üí GND
‚îÇ   1N4001 Diode parallel to relay coil

‚îú‚îÄ‚îÄ üìä GY-30 SENSOR (GY-30)
‚îÇ   GPIO13 ‚Üí SDA
‚îÇ   GPIO14 ‚Üí SCL  
‚îÇ   3.3V ‚Üí VCC
‚îÇ   GND ‚Üí GND

‚îú‚îÄ‚îÄ üåà RGB INDICATOR (WS2812B)
‚îÇ   GPIO5 ‚Üí DIN
‚îÇ   5V ‚Üí VCC
‚îÇ   GND ‚Üí GND

‚îî‚îÄ‚îÄ üí° STATUS LED
    GPIO2 ‚Üí LED anode (via 220Œ©)
    GND ‚Üí LED cathode

## üíæ Software Architecture

### Project Files

**PhytoController.ino** - Main file, initialization and main loop

**Config.h/Config.cpp** - System settings and pin configuration

**DebugLogger.h/DebugLogger.cpp** - Logging and debugging system

**LightSensor.h/LightSensor.cpp** - GY-30 light sensor operation

**RelayController.h/RelayController.cpp** - Relay and load control

**RGBLed.h/RGBLed.cpp** - RGB indicator control

**Secrets.h** - Private network settings, WiFi login/password

**WebAPI.h/WebAPI.cpp** - API system for web operation

## üîß Installation and Setup

1. Install libraries: GY-30, FastLED
2. Connect components according to the diagram
3. Flash the code to ESP32
4. Open Serial Monitor (115200 baud)
5. To connect to WebAPI, use the controller network "PhytoController" with password 12345678.
Or specify network connection parameters in the secrets.h file
6. Network connection address is 192.168.4.1

## üöÄ Features

- Automatic phytolamp control based on light threshold
- RGB system status indication
- Data and event logging
- Support for GY-30 and VEML7700 sensors
- ESD and overload protection
- WebAPI control via its own WiFi network or via connection network (specified in secrets.h file)

_________________________________________________________________

# üå± PhytoController - –£–º–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Ñ–∏—Ç–æ–æ—Å–≤–µ—â–µ–Ω–∏—è

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ—â–Ω—ã–º–∏ —Ñ–∏—Ç–æ–ª–∞–º–ø–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω–æ–π –æ—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç–∏.

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∏—Ç–æ—Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞–º–∏ (30-50–í—Ç) –≤ —É—Å–ª–æ–≤–∏—è—Ö –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Å–≤–µ—â–µ–Ω–∏—è:
- **–°–æ–ª–Ω–µ—á–Ω—ã–π —Å–≤–µ—Ç** - –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫  
- **–§–∏—Ç–æ–ª–∞–º–ø—ã** - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ—Å–≤–µ—Ç–∫–∞ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–≤–µ—Ç–∞

## üîå –ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —á–∞—Å—Ç—å

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä**: ESP32-WROOM —Å CP2102
- **–î–∞—Ç—á–∏–∫ –æ—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç–∏**: GY-30 (BH1750) –∏–ª–∏ VEML7700
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–æ–π**: –†–µ–ª–µ 12V —á–µ—Ä–µ–∑ —Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä TIP122
- **–ò–Ω–¥–∏–∫–∞—Ü–∏—è**: RGB —Å–≤–µ—Ç–æ–¥–∏–æ–¥ WS2812B
- **–ü–∏—Ç–∞–Ω–∏–µ**: –ü–æ–≤—ã—à–∞—é—â–∏–π –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å 5V‚Üí12V

### –°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

ESP32-WROOM (CP2102)

‚îú‚îÄ‚îÄ üîå –°–•–ï–ú–ê –†–ï–õ–ï
‚îÇ   GPIO4 ‚Üí –†–µ–∑–∏—Å—Ç–æ—Ä 680Œ© ‚Üí –ë–∞–∑–∞ TIP122
‚îÇ   –ö–æ–ª–ª–µ–∫—Ç–æ—Ä TIP122 ‚Üí –ö–∞—Ç—É—à–∫–∞ —Ä–µ–ª–µ
‚îÇ   –≠–º–∏—Ç—Ç–µ—Ä TIP122 ‚Üí GND
‚îÇ   –î–∏–æ–¥ 1N4001 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∫–∞—Ç—É—à–∫–µ —Ä–µ–ª–µ

‚îú‚îÄ‚îÄ üìä –î–ê–¢–ß–ò–ö GY-30 (GY-30)
‚îÇ   GPIO13 ‚Üí SDA
‚îÇ   GPIO14 ‚Üí SCL  
‚îÇ   3.3V ‚Üí VCC
‚îÇ   GND ‚Üí GND

‚îú‚îÄ‚îÄ üåà RGB –ò–ù–î–ò–ö–ê–¢–û–† (WS2812B)
‚îÇ   GPIO5 ‚Üí DIN
‚îÇ   5V ‚Üí VCC
‚îÇ   GND ‚Üí GND

‚îî‚îÄ‚îÄ üí° –°–¢–ê–¢–£–°–ù–´–ô LED
    GPIO2 ‚Üí –ê–Ω–æ–¥ —Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞ (—á–µ—Ä–µ–∑ 220Œ©)
    GND ‚Üí –ö–∞—Ç–æ–¥ —Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞

## üíæ –ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

**PhytoController.ino** - –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª

**Config.h/Config.cpp** - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–∏–Ω–æ–≤

**DebugLogger.h/DebugLogger.cpp** - –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏

**LightSensor.h/LightSensor.cpp** - –†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç—á–∏–∫–æ–º –æ—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç–∏ GY-30

**RelayController.h/RelayController.cpp** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–ª–µ –∏ –Ω–∞–≥—Ä—É–∑–∫–æ–π

**RGBLed.h/RGBLed.cpp** - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ RGB –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π

**Secrets.h** - –ß–∞—Å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏ –∏ —Ç.–¥. –õ–æ–∏–Ω\–ø–∞—Ä–æ–ª—å –æ—Ç wifi

**WebAPI.h/WebAPI.cpp** - –°–∏—Å—Ç–µ–º–∞ API –¥–ª—è —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ Web 

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. –£—Å—Ç–∞–Ω–æ–≤–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏: GY-30, FastLED
2. –ü–æ–¥–∫–ª—é—á–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ —Å—Ö–µ–º–µ
3. –ü—Ä–æ—à–µ–π –∫–æ–¥ –Ω–∞ ESP32
4. –û—Ç–∫—Ä–æ–π Serial Monitor (115200 –±–æ–¥)
5. –î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ WebAPI –∏—Å–ø–æ–ª—å–∑—É–π —Å–µ—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ PhytoController c –ø–∞—Ä–æ–ª–µ–º 12345678.
–ò–ª–∏ —É–∫–∞–∂–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ—Ç–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–µ secrets.h
6. –ê–¥—Ä–µ—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å–≤–æ–µ–π —Å–µ—Ç–∏ 192.168.4.1

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏—Ç–æ–ª–∞–º–ø–æ–π –ø–æ –ø–æ—Ä–æ–≥—É –æ—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç–∏
- RGB –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–±—ã—Ç–∏–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–∞—Ç—á–∏–∫–æ–≤ GY-30 –∏ VEML7700
- –ó–∞—â–∏—Ç–∞ –æ—Ç ESD –∏ –ø–µ—Ä–µ–≥—Ä—É–∑–æ–∫
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ WebAPI —á–µ—Ä–µ–∑ —Å–≤–æ—é —Å–µ—Ç—å wifi, –∏–ª–∏ —á–µ—Ä–µ–∑ —Å–µ—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (—É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Ñ–∞–π–ª–µ secrets.h).